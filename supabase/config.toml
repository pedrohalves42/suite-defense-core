project_id = "iavbnmduxpxhwubqrzzn"

# === Stripe Functions ===
[functions.create-stripe-products]
verify_jwt = true

[functions.create-checkout]
verify_jwt = true

[functions.check-subscription]
verify_jwt = true

[functions.customer-portal]
verify_jwt = true

[functions.list-invoices]
verify_jwt = true

[functions.stripe-webhook]
verify_jwt = false

[functions.sync-stripe-subscriptions]
verify_jwt = false

# === Trial Period Functions ===
[functions.check-trial-expiration]
verify_jwt = false
schedule = "0 */12 * * *"

[functions.send-trial-reminder]
verify_jwt = false

[functions.subscription-analytics]
verify_jwt = true

[functions.stripe-health-check]
verify_jwt = true

# === Agent Functions ===
[functions.enroll-agent]
verify_jwt = false

[functions.heartbeat]
verify_jwt = false

[functions.poll-jobs]
verify_jwt = false

[functions.ack-job]
verify_jwt = false

[functions.submit-system-metrics]
verify_jwt = false

[functions.upload-report]
verify_jwt = false

[functions.scan-virus]
verify_jwt = false

[functions.validate-agent-health]
verify_jwt = true

[functions.check-agent-updates]
verify_jwt = false

# === Installation Functions ===
[functions.auto-generate-enrollment]
verify_jwt = true

[functions.serve-installer]
verify_jwt = false

[functions.track-installation-event]
verify_jwt = true

[functions.post-installation-telemetry]
verify_jwt = false

# === Admin Functions ===
[functions.create-job]
verify_jwt = true

[functions.list-users]
verify_jwt = true

[functions.list-all-users-admin]
verify_jwt = true

[functions.update-user-status]
verify_jwt = true

[functions.update-user-role]
verify_jwt = true

[functions.update-member-role]
verify_jwt = true

[functions.generate-enrollment-key]
verify_jwt = true

[functions.cleanup-expired-enrollment-keys]
verify_jwt = true

[functions.check-expiring-enrollment-keys]
verify_jwt = false

[functions.check-agent-name-availability]
verify_jwt = true

[functions.get-agent-dashboard-data]
verify_jwt = true

[functions.list-reports]
verify_jwt = false

[functions.check-tenant-quotas]
verify_jwt = true

[functions.api-tenant-features]
verify_jwt = true

[functions.api-tenant-info]
verify_jwt = true

[functions.api-tenant-stats]
verify_jwt = true

# === Monitoring Functions ===
[functions.monitor-agent-health]
verify_jwt = false
schedule = "*/5 * * * *"

[functions.monitor-thresholds]
verify_jwt = false

[functions.analyze-network-anomalies]
verify_jwt = true

# === Alert Functions ===
[functions.send-alert-email]
verify_jwt = false

[functions.send-system-alert]
verify_jwt = false

[functions.send-health-alert]
verify_jwt = false

[functions.send-security-alert]
verify_jwt = true

[functions.send-welcome-email]
verify_jwt = false

# === Auth Functions ===
[functions.send-invite]
verify_jwt = true

[functions.accept-invite]
verify_jwt = true

[functions.record-failed-login]
verify_jwt = false

[functions.check-failed-logins]
verify_jwt = false

[functions.clear-failed-logins]
verify_jwt = false

[functions.test-internal-auth]
verify_jwt = true

# === Scheduled Functions ===
[functions.reset-daily-quotas]
verify_jwt = false

[functions.process-scheduled-jobs]
verify_jwt = false

[functions.auto-quarantine]
verify_jwt = false

# === Contact Functions ===
[functions.submit-contact]
verify_jwt = false

# === Monitoring Functions (FASE 4.1) ===
[functions.monitor-slow-operations]
verify_jwt = false
schedule = "*/5 * * * *"

# === Test Functions ===
[functions.test-virustotal-integration]
verify_jwt = true

[functions.test-stripe-integration]
verify_jwt = true

[functions.test-webhook]
verify_jwt = true
